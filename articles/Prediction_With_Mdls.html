<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Predict Adolescent AQoL-6D • youthu</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Predict Adolescent AQoL-6D">
<meta property="og:description" content="youthu">
<meta property="og:image" content="/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">youthu</a>
        <span class="version label label-danger" data-toggle="tooltip" data-placement="bottom" title="Unreleased version">0.0.0.9061</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/youthu.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Economic_Analysis.html">Economic analysis</a>
    </li>
    <li>
      <a href="../articles/Prediction_With_Mdls.html">Predict Adolescent AQoL-6D</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/ready4-dev/youthu/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="Prediction_With_Mdls_files/accessible-code-block-0.0.1/empty-anchor.js"></script><script src="Prediction_With_Mdls_files/kePrint-0.0.1/kePrint.js"></script><link href="Prediction_With_Mdls_files/lightable-0.0.1/lightable.css" rel="stylesheet">
<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Predict Adolescent AQoL-6D</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/ready4-dev/youthu/blob/master/vignettes/Prediction_With_Mdls.Rmd"><code>vignettes/Prediction_With_Mdls.Rmd</code></a></small>
      <div class="hidden name"><code>Prediction_With_Mdls.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://magrittr.tidyverse.org">magrittr</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ready4-dev.github.io/youthu/">youthu</a></span><span class="op">)</span></code></pre></div>
<div id="determining-if-youthu-models-can-be-applied-to-a-dataset" class="section level2">
<h2 class="hasAnchor">
<a href="#determining-if-youthu-models-can-be-applied-to-a-dataset" class="anchor"></a>Determining if youthu models can be applied to a dataset</h2>
<p>To use youthu to predict health utility values for records in a dataset, it is necessary for that dataset to include one or more of the predictors used in the youthu models. To verify that this is the case it is necessary to identify the predictors used in youthu models and to then compare these to the variables in the dataset being used for prediction.</p>
<div id="identify-measures-that-can-be-used-to-predict-health-utility-with-youthu-models" class="section level3">
<h3 class="hasAnchor">
<a href="#identify-measures-that-can-be-used-to-predict-health-utility-with-youthu-models" class="anchor"></a>Identify measures that can be used to predict health utility with youthu models</h3>
<p>To identify the predictors in youthu models consult the <code class="sourceCode r">predictors_lup</code> lookup table.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"predictors_lup"</span><span class="op">)</span>
<span class="va">predictors_lup</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span></code></pre></div>
<table class="table  lightable-paper lightable-hover">
<caption>
Predictors used in youthu models
</caption>
<thead><tr>
<th style="text-align:left;">
short_name_chr
</th>
<th style="text-align:right;">
long_name_chr
</th>
<th style="text-align:right;">
min_val_dbl
</th>
<th style="text-align:right;">
max_val_dbl
</th>
<th style="text-align:right;">
class_chr
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
BADS
</td>
<td style="text-align:right;">
BADS total score
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
150
</td>
<td style="text-align:right;">
integer
</td>
</tr>
<tr>
<td style="text-align:left;">
GAD7
</td>
<td style="text-align:right;">
GAD7 total score
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
21
</td>
<td style="text-align:right;">
integer
</td>
</tr>
<tr>
<td style="text-align:left;">
K6
</td>
<td style="text-align:right;">
K6 total score
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
24
</td>
<td style="text-align:right;">
integer
</td>
</tr>
<tr>
<td style="text-align:left;">
OASIS
</td>
<td style="text-align:right;">
OASIS total score
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
20
</td>
<td style="text-align:right;">
integer
</td>
</tr>
<tr>
<td style="text-align:left;">
PHQ9
</td>
<td style="text-align:right;">
PHQ9 total score
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
27
</td>
<td style="text-align:right;">
integer
</td>
</tr>
<tr>
<td style="text-align:left;">
SCARED
</td>
<td style="text-align:right;">
SCARED total score
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
82
</td>
<td style="text-align:right;">
integer
</td>
</tr>
<tr>
<td style="text-align:left;">
SOFAS
</td>
<td style="text-align:right;">
SOFAS total score
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
100
</td>
<td style="text-align:right;">
integer
</td>
</tr>
</tbody>
<tfoot><tr>
<td style="padding: 0; " colspan="100%">
<sup></sup>
</td>
</tr></tfoot>
</table>
</div>
<div id="match-model-predictors-to-the-prediction-dataset" class="section level3">
<h3 class="hasAnchor">
<a href="#match-model-predictors-to-the-prediction-dataset" class="anchor"></a>Match model predictors to the prediction dataset</h3>
<p>Next, we can identify which of the above variables are present in the dataset we plan to use for prediction. To illustrate this step, we have created a prediction dataset that is a modified and simplified version of the study <a href="https://ready4-dev.github.io/youthvars/articles/Replication_DS.html">replication dataset</a> distributed with the youthvars package. This illustrative dataset reflects the likely real-world circumstance in which the prediction dataset uses a different naming convention to that of the dataset we used to estimate the youth models.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">data_tb</span> <span class="op">&lt;-</span> <span class="fu">youthvars</span><span class="fu">::</span><span class="va"><a href="https://ready4-dev.github.io/youthvars/reference/replication_popl_tb.html">replication_popl_tb</a></span> <span class="op">%&gt;%</span>
  <span class="fu">youthvars</span><span class="fu">::</span><span class="fu"><a href="https://ready4-dev.github.io/youthvars/reference/transform_raw_ds_for_analysis.html">transform_raw_ds_for_analysis</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">fkClientID</span>,<span class="va">round</span>,<span class="va">PHQ9</span>, <span class="va">SOFAS</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="co">#</span>
  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span><span class="op">(</span><span class="va">fkClientID</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html">na.omit</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html">rename</a></span><span class="op">(</span>UID <span class="op">=</span> <span class="va">fkClientID</span>,
                Timepoint <span class="op">=</span> <span class="va">round</span>,
                PHQ_total <span class="op">=</span> <span class="va">PHQ9</span>,
                SOFAS_total <span class="op">=</span> <span class="va">SOFAS</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>SOFAS_total <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html">as.integer</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">SOFAS_total</span>,<span class="fl">0</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html">as_tibble</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">data_tb</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<table class="table  lightable-paper lightable-hover">
<caption>
Illustrative example of a prediction dataset
</caption>
<thead><tr>
<th style="text-align:left;">
UID
</th>
<th style="text-align:right;">
Timepoint
</th>
<th style="text-align:right;">
PHQ_total
</th>
<th style="text-align:right;">
SOFAS_total
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
Participant_1
</td>
<td style="text-align:right;">
Baseline
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
69
</td>
</tr>
<tr>
<td style="text-align:left;">
Participant_10
</td>
<td style="text-align:right;">
Baseline
</td>
<td style="text-align:right;">
17
</td>
<td style="text-align:right;">
60
</td>
</tr>
<tr>
<td style="text-align:left;">
Participant_10
</td>
<td style="text-align:right;">
Follow-up
</td>
<td style="text-align:right;">
17
</td>
<td style="text-align:right;">
64
</td>
</tr>
<tr>
<td style="text-align:left;">
Participant_100
</td>
<td style="text-align:right;">
Baseline
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
76
</td>
</tr>
<tr>
<td style="text-align:left;">
Participant_1000
</td>
<td style="text-align:right;">
Baseline
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
71
</td>
</tr>
<tr>
<td style="text-align:left;">
Participant_1000
</td>
<td style="text-align:right;">
Follow-up
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
71
</td>
</tr>
</tbody>
<tfoot><tr>
<td style="padding: 0; " colspan="100%">
<sup></sup>
</td>
</tr></tfoot>
</table>
<p>A visual inspection of the illustrative prediction dataset we have created reveals that the only predictors that match those included in youthu models are PHQ9 and SOFAS (the fifth and seventh rows of the <code class="sourceCode r">predictors_lup</code> lookup table). We can create a character vector to store this information as we will need it later. Note, the names stored in <code>mdl_predrs_in_ds_chr</code> must use the naming convention specified in the <code class="sourceCode r">predictors_lup</code> lookup table and not any different naming convention that may be used in the prediction dataset for the equivalent variables (in this case <code>PHQ_total</code> and <code>SOFAS_total</code>).</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mdl_predrs_in_ds_chr</span> <span class="op">&lt;-</span> <span class="va">predictors_lup</span><span class="op">$</span><span class="va">short_name_chr</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">5</span>,<span class="fl">7</span><span class="op">)</span><span class="op">]</span>
<span class="va">mdl_predrs_in_ds_chr</span></code></pre></div>
<pre><code>## [1] "PHQ9"  "SOFAS"</code></pre>
</div>
<div id="predictor-data-integrity-checks" class="section level3">
<h3 class="hasAnchor">
<a href="#predictor-data-integrity-checks" class="anchor"></a>Predictor data integrity checks</h3>
<p>Another requirement is that the predictor variables in the prediction dataset must contain no missing values and conform to the requirements of class (in this case <code class="sourceCode r">integer</code>) and minimum and maximum values that are specified in the <code class="sourceCode r">predictors_lup</code> lookup table. We can confirm that these conditions hold by either visually inspecting the output of calls to base R <code class="sourceCode r">summary</code> and <code class="sourceCode r">class</code> functions or by using youthu’s <a href="Data_Integrity.html">data integrity tools</a>.</p>
<div id="visual-inspection-checks" class="section level4">
<h4 class="hasAnchor">
<a href="#visual-inspection-checks" class="anchor"></a>Visual inspection checks</h4>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">data_tb</span><span class="op">$</span><span class="va">PHQ_total</span><span class="op">)</span></code></pre></div>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##    0.00    7.00   12.00   11.55   16.00   27.00</code></pre>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/class.html">class</a></span><span class="op">(</span><span class="va">data_tb</span><span class="op">$</span><span class="va">PHQ_total</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] "integer"</code></pre>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">data_tb</span><span class="op">$</span><span class="va">SOFAS_total</span><span class="op">)</span></code></pre></div>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##   34.00   60.00   67.00   66.97   74.00   98.00</code></pre>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/class.html">class</a></span><span class="op">(</span><span class="va">data_tb</span><span class="op">$</span><span class="va">SOFAS_total</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] "integer"</code></pre>
</div>
<div id="checks-using-youthvars-classes" class="section level4">
<h4 class="hasAnchor">
<a href="#checks-using-youthvars-classes" class="anchor"></a>Checks using youthvars classes</h4>
<p>We can pass the values of the <code>PHQ9_total</code> and <code>SOFAS_total</code> variables in our dataset to the functions for creating instances of the <code>youthvars_phq9</code> and <code>youthvars_sofas</code> classes from the <a href="https://ready4-dev.github.io/youthvars/">youthvars</a> package. If no error message is thrown, then the data is consistent with the requirements for variable.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">phq9_test</span> <span class="op">&lt;-</span> <span class="fu">youthvars</span><span class="fu">::</span><span class="fu"><a href="https://ready4-dev.github.io/youthvars/reference/youthvars_phq9.html">youthvars_phq9</a></span><span class="op">(</span><span class="va">data_tb</span><span class="op">$</span><span class="va">PHQ_total</span><span class="op">)</span> 
<span class="va">phq9_test</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/base/class.html">class</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] "youthvars_phq9" "integer"</code></pre>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">sofas_test</span> <span class="op">&lt;-</span> <span class="fu">youthvars</span><span class="fu">::</span><span class="fu"><a href="https://ready4-dev.github.io/youthvars/reference/youthvars_sofas.html">youthvars_sofas</a></span><span class="op">(</span><span class="va">data_tb</span><span class="op">$</span><span class="va">SOFAS_total</span><span class="op">)</span> 
<span class="va">sofas_test</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/base/class.html">class</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] "youthvars_sofas" "integer"</code></pre>
</div>
</div>
<div id="confirm-dataset-meets-other-structural-requirements" class="section level3">
<h3 class="hasAnchor">
<a href="#confirm-dataset-meets-other-structural-requirements" class="anchor"></a>Confirm dataset meets other structural requirements</h3>
<p>In addition to containing at least one match for the predictors used in youthu models, the prediction dataset must include both a unique client identifier variable (<code class="sourceCode r">character</code> class) and a measurement time-point identifier variable (<code class="sourceCode r">factor</code> class, with two levels). The dataset also needs to be in long format (ie where measures at different time-points for the same individual are stacked on top of each other in separate rows). We can confirm these conditions hold both by visual inspection of the dataset and investigation of the classes of the unique identified and measurement timepoint variables.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">data_tb</span><span class="op">$</span><span class="va">UID</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/base/class.html">class</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] "character"</code></pre>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">data_tb</span><span class="op">$</span><span class="va">Timepoint</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/base/class.html">class</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] "factor"</code></pre>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/levels.html">levels</a></span><span class="op">(</span><span class="va">data_tb</span><span class="op">$</span><span class="va">Timepoint</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] "Baseline"  "Follow-up"</code></pre>
</div>
</div>
<div id="identify-candidate-models-for-available-predictors" class="section level2">
<h2 class="hasAnchor">
<a href="#identify-candidate-models-for-available-predictors" class="anchor"></a>Identify candidate models for available predictors</h2>
<p>We can use the <code class="sourceCode r">get_mdls_using_predrs</code> function to identify which models can be used with the predictors present in the prediction dataset. The only argument that we need to pass to that function is our previously created <code class="sourceCode r">mdl_predrs_in_ds_chr</code> vector of predictors that are common to both our prediction dataset and youthu models.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"mdls_lup"</span>, package <span class="op">=</span><span class="st">"youthu"</span><span class="op">)</span>
<span class="va">candidate_mdls_tb</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_mdls_using_predrs.html">get_mdls_using_predrs</a></span><span class="op">(</span><span class="va">mdl_predrs_in_ds_chr</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">candidate_mdls_tb</span></code></pre></div>
<table class="table  lightable-paper lightable-hover">
<caption>
youthu models that can be applied to the prediction dataset
</caption>
<thead><tr>
<th style="text-align:left;">
mdl_nms_chr
</th>
<th style="text-align:right;">
predrs_ls
</th>
<th style="text-align:right;">
mdl_type_chr
</th>
<th style="text-align:right;">
tfmn_chr
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
PHQ9_1_GLM_GSN_LOG
</td>
<td style="text-align:right;">
PHQ9
</td>
<td style="text-align:right;">
GLM
</td>
<td style="text-align:right;">
LOG
</td>
</tr>
<tr>
<td style="text-align:left;">
PHQ9_1_OLS_CLL
</td>
<td style="text-align:right;">
PHQ9
</td>
<td style="text-align:right;">
OLS
</td>
<td style="text-align:right;">
CLL
</td>
</tr>
<tr>
<td style="text-align:left;">
PHQ9_SOFAS_1_GLM_GSN_LOG
</td>
<td style="text-align:right;">
PHQ9 , SOFAS
</td>
<td style="text-align:right;">
GLM
</td>
<td style="text-align:right;">
LOG
</td>
</tr>
<tr>
<td style="text-align:left;">
PHQ9_SOFAS_1_OLS_CLL
</td>
<td style="text-align:right;">
PHQ9 , SOFAS
</td>
<td style="text-align:right;">
OLS
</td>
<td style="text-align:right;">
CLL
</td>
</tr>
</tbody>
<tfoot><tr>
<td style="padding: 0; " colspan="100%">
<sup></sup>
</td>
</tr></tfoot>
</table>
</div>
<div id="select-and-download-preferred-model" class="section level2">
<h2 class="hasAnchor">
<a href="#select-and-download-preferred-model" class="anchor"></a>Select and download preferred model</h2>
<p>All youthu models are publicly available in a Dataverse repository (<a href="https://doi.org/10.7910/DVN/JC6PTV" class="uri">https://doi.org/10.7910/DVN/JC6PTV</a>). The following function call will download the desired model from the data repository. To download a choosen model, use the <code class="sourceCode r">get_mdl_from_dv</code> function. In the below example we have selected the fourth model in the candidate models table (PHQ9_SOFAS_1_OLS_CLL). We suggest consulting the scientific summary of the study that produced the youthu models to help guide your choice of which candidate model to select.</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">model_mdl</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_mdl_from_dv.html">get_mdl_from_dv</a></span><span class="op">(</span><span class="va">candidate_mdls_tb</span><span class="op">$</span><span class="va">mdl_nms_chr</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">model_mdl</span> </code></pre></div>
<pre><code>## 
## Call:
## lm(formula = aqol6d_total_w_CLL ~ PHQ9_baseline + PHQ9_change + 
##     SOFAS_baseline + SOFAS_change, data = data_tb)
## 
## Coefficients:
##    (Intercept)   PHQ9_baseline     PHQ9_change  SOFAS_baseline    SOFAS_change  
##         -0.147          -6.732          -4.202           1.470           1.044</code></pre>
</div>
<div id="predict-utility" class="section level2">
<h2 class="hasAnchor">
<a href="#predict-utility" class="anchor"></a>Predict utility</h2>
<p>To generate utility predictions we use the <code class="sourceCode r">add_aqol6d_predn_to_ds</code> function. The function needs to be supplied with the prediction dataset (the value passed to argument <code>data_tb</code>), the model we are applying to that dataset (<code>model_mdl</code>), the transformation associated with that model (<code>tfmn_1L_chr</code>, which can be identified by passing the name of the selected model to the <code class="sourceCode r">get_tfmn_from_lup</code> function) and details of the variable names used in the prediction dataset for the unique identifier (<code>id_var_nm_1L_chr</code>) and measurement timepoint (<code>round_var_nm_1L_chr</code>) and, for the later, the factor level that represents the baseline timepoint (<code>round_bl_val_1L_chr</code>). Additionally, if the prediction dataset uses different variable names for the predictors to those specified in the <code class="sourceCode r">predictors_lup</code> lookup table, a named vector detailing the correspondence between the two sets of variable names needs to be passed to the <code>predr_vars_nms_chr</code> argument. Finally, if you wish to specify the desired variable name to use for the predicted utility values generated by the function, you can do this by passing this name to the <code>utl_var_nm_1L_chr</code> argument.</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">updated_data_tb</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/add_aqol6d_predn_to_ds.html">add_aqol6d_predn_to_ds</a></span><span class="op">(</span>data_tb <span class="op">=</span> <span class="va">data_tb</span>,
                                   model_mdl <span class="op">=</span> <span class="va">model_mdl</span>,
                                   predr_vars_nms_chr <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>PHQ9 <span class="op">=</span> <span class="st">"PHQ_total"</span>, SOFAS <span class="op">=</span> <span class="st">"SOFAS_total"</span><span class="op">)</span>,
                                   tfmn_1L_chr <span class="op">=</span> <span class="fu"><a href="../reference/get_tfmn_from_lup.html">get_tfmn_from_lup</a></span><span class="op">(</span><span class="va">candidate_mdls_tb</span><span class="op">$</span><span class="va">mdl_nms_chr</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span><span class="op">)</span>,
                                   utl_var_nm_1L_chr <span class="op">=</span> <span class="st">"AQoL6D_HU"</span>,
                                   id_var_nm_1L_chr <span class="op">=</span> <span class="st">"UID"</span>,
                                   round_var_nm_1L_chr <span class="op">=</span> <span class="st">"Timepoint"</span>,
                                   round_bl_val_1L_chr <span class="op">=</span> <span class="st">"Baseline"</span><span class="op">)</span></code></pre></div>
<pre><code>## Joining, by = c("UID", "Timepoint")</code></pre>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">updated_data_tb</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<table class="table  lightable-paper lightable-hover">
<caption>
Prediction dataset with predicted utilities
</caption>
<thead><tr>
<th style="text-align:left;">
UID
</th>
<th style="text-align:right;">
Timepoint
</th>
<th style="text-align:right;">
PHQ_total
</th>
<th style="text-align:right;">
SOFAS_total
</th>
<th style="text-align:right;">
AQoL6D_HU
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
Participant_1
</td>
<td style="text-align:right;">
Baseline
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
69
</td>
<td style="text-align:right;">
0.7737147
</td>
</tr>
<tr>
<td style="text-align:left;">
Participant_10
</td>
<td style="text-align:right;">
Baseline
</td>
<td style="text-align:right;">
17
</td>
<td style="text-align:right;">
60
</td>
<td style="text-align:right;">
0.4852233
</td>
</tr>
<tr>
<td style="text-align:left;">
Participant_10
</td>
<td style="text-align:right;">
Follow-up
</td>
<td style="text-align:right;">
17
</td>
<td style="text-align:right;">
64
</td>
<td style="text-align:right;">
0.4995956
</td>
</tr>
<tr>
<td style="text-align:left;">
Participant_100
</td>
<td style="text-align:right;">
Baseline
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
76
</td>
<td style="text-align:right;">
0.9285296
</td>
</tr>
<tr>
<td style="text-align:left;">
Participant_1000
</td>
<td style="text-align:right;">
Baseline
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
71
</td>
<td style="text-align:right;">
0.9138357
</td>
</tr>
<tr>
<td style="text-align:left;">
Participant_1000
</td>
<td style="text-align:right;">
Follow-up
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
71
</td>
<td style="text-align:right;">
0.9138357
</td>
</tr>
</tbody>
<tfoot><tr>
<td style="padding: 0; " colspan="100%">
<sup></sup>
</td>
</tr></tfoot>
</table>
<p>Our health utility predictions are now available for use and are summarised below.</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">updated_data_tb</span><span class="op">$</span><span class="va">AQoL6D_HU</span><span class="op">)</span></code></pre></div>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##  0.2118  0.5188  0.6424  0.6390  0.7661  0.9658</code></pre>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Matthew Hamilton, Caroline Gao, Orygen, Headspace, National Health and Medical Research Council.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
